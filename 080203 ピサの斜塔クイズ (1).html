<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç©ºé–“å›³å½¢ã‚¯ã‚¤ã‚ºï¼šãƒ”ã‚µã®æ–œå¡”</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .camera-btn { transition: all 0.2s; }
        .camera-btn:active { transform: scale(0.95); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center justify-center p-4 text-gray-800">

    <!-- ç”»é¢1: ã‚¤ãƒ³ãƒˆãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div id="intro-screen" class="max-w-lg w-full bg-white rounded-2xl shadow-xl p-8 text-center border-b-4 border-indigo-200">
        <div class="w-20 h-20 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-6 text-indigo-600">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>
        </div>
        <h1 class="text-2xl font-bold mb-4">ç«‹ä½“ã®è¦‹æ–¹ã‚¯ã‚¤ã‚º<br>å†™çœŸã®å ´æ‰€ã¯ã©ã“ï¼Ÿ</h1>
        <p class="text-gray-600 mb-8 leading-relaxed text-left">
            åœ°å›³ã®çœŸã‚“ä¸­ã«ã‚ã‚‹å¡”ã¯ã€<strong class="text-indigo-600">å—ï¼ˆåœ°å›³ã®ä¸‹æ–¹å‘ï¼‰</strong>ã«å‚¾ã„ã¦ã„ã¾ã™ã€‚<br><br>
            ã“ã‚Œã‹ã‚‰å‡ºã‚‹ã€Œå†™çœŸã€ã‚’è¦‹ã¦ã€åœ°å›³ä¸Šã®ã©ã®å ´æ‰€ï¼ˆAã€œHï¼‰ã‹ã‚‰æ’®å½±ã—ãŸã‹å½“ã¦ã¦ã¿ã¾ã—ã‚‡ã†ï¼
        </p>
        <button onclick="startQuiz()" class="w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-lg shadow-lg transition transform hover:scale-[1.02]">
            ã‚¯ã‚¤ã‚ºã‚’å§‹ã‚ã‚‹
        </button>
    </div>

    <!-- ç”»é¢2: ã‚¯ã‚¤ã‚ºæœ¬ç·¨ -->
    <div id="quiz-screen" class="hidden w-full max-w-4xl">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="flex justify-between items-center mb-6 px-2">
            <div class="flex items-center gap-2 text-indigo-800 font-bold">
                <span class="bg-indigo-100 px-3 py-1 rounded-full text-sm">ç¬¬ <span id="q-num">1</span> å•</span>
                <span class="text-sm">/ å…¨5å•</span>
            </div>
            <div class="text-gray-500 font-semibold">ã‚¹ã‚³ã‚¢: <span id="current-score">0</span></div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
            <!-- å·¦å´ï¼šå†™çœŸè¡¨ç¤º -->
            <div class="flex flex-col gap-4">
                <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                    <h3 class="text-lg font-bold text-gray-700 mb-3 flex items-center gap-2">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-500"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>
                        æ’®ã‚ŒãŸå†™çœŸ
                    </h3>
                    <div id="tower-image-container" class="aspect-[4/3] w-full mx-auto bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">
                        <!-- SVGãŒã“ã“ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->
                    </div>
                    <p id="image-hint" class="mt-3 text-center text-gray-600 font-medium text-sm md:text-base"></p>
                </div>
            </div>

            <!-- å³å´ï¼šåœ°å›³ã¨æ“ä½œ -->
            <div class="flex flex-col gap-4">
                <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 h-full flex flex-col relative">
                    <h3 class="text-lg font-bold text-gray-700 mb-3 flex items-center gap-2">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-600"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" y1="2" x2="8" y2="18"/><line x1="16" y1="6" x2="16" y2="22"/></svg>
                        æ’®å½±å ´æ‰€ã‚’é¸ã¼ã†
                    </h3>
                    
                    <!-- åœ°å›³ã‚¨ãƒªã‚¢ -->
                    <div class="relative w-full max-w-sm aspect-square bg-green-50 rounded-xl border-2 border-green-200 mx-auto overflow-hidden mb-4 select-none">
                        <!-- èƒŒæ™¯ã‚°ãƒªãƒƒãƒ‰ -->
                        <div class="absolute inset-0 opacity-10 pointer-events-none">
                            <div class="absolute w-full h-px bg-green-800 top-1/2"></div>
                            <div class="absolute h-full w-px bg-green-800 left-1/2"></div>
                            <div class="absolute w-full h-px bg-green-800 top-1/2 rotate-45 transform scale-150"></div>
                            <div class="absolute h-full w-px bg-green-800 left-1/2 rotate-45 transform scale-150"></div>
                            <div class="absolute top-2 right-1/2 translate-x-1/2 text-green-900 font-bold text-3xl">N</div>
                        </div>

                        <!-- ä¸­å¤®ã®å¡” -->
                        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-20 h-20 bg-yellow-100 rounded-full border-4 border-yellow-500 flex items-center justify-center shadow-lg z-0">
                            <div class="flex flex-col items-center">
                                <span class="text-[10px] font-bold text-yellow-800 mb-1">å¡”</span>
                                <div class="flex flex-col items-center">
                                    <div class="w-1.5 h-6 bg-yellow-600 rounded-full mb-0.5"></div>
                                    <div class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-t-[8px] border-t-yellow-600"></div>
                                </div>
                                <span class="text-[8px] text-yellow-700 mt-0.5">å—ã¸å‚¾ã</span>
                            </div>
                        </div>

                        <!-- ãƒœã‚¿ãƒ³é…ç½®ã‚¨ãƒªã‚¢ -->
                        <div id="map-buttons"></div>
                    </div>

                    <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ -->
                    <div id="action-area" class="min-h-[120px]">
                        <div id="submit-section" class="flex flex-col gap-3">
                            <p class="text-center text-sm text-gray-500">åœ°å›³ä¸Šã® A ã€œ H ã‚’ã‚¿ãƒƒãƒ—ã—ã¦é¸æŠ</p>
                            <button id="submit-btn" onclick="submitAnswer()" disabled class="w-full py-3 rounded-xl font-bold text-lg shadow-md transition-all bg-gray-200 text-gray-400 cursor-not-allowed">
                                å›ç­”ã™ã‚‹
                            </button>
                        </div>

                        <div id="result-section" class="hidden p-4 rounded-xl border-2 fade-in">
                            <div class="flex items-center gap-3 mb-2">
                                <div id="result-icon"></div>
                                <span id="result-title" class="text-xl font-bold"></span>
                            </div>
                            <p class="text-gray-700 text-sm mb-4 leading-relaxed">
                                <span class="font-bold">è§£èª¬ï¼š</span><span id="explanation-text"></span>
                            </p>
                            <button onclick="nextQuestion()" id="next-btn" class="w-full py-2 bg-gray-800 hover:bg-gray-900 text-white rounded-lg font-bold text-sm">
                                æ¬¡ã®å•é¡Œã¸
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç”»é¢3: çµæœç™ºè¡¨ -->
    <div id="final-screen" class="hidden max-w-lg w-full bg-white rounded-2xl shadow-xl p-8 text-center">
        <h2 class="text-3xl font-bold text-gray-800 mb-2">çµæœç™ºè¡¨ï¼</h2>
        <div class="py-8">
            <div class="text-6xl font-black text-indigo-600 mb-2">
                <span id="final-score">0</span> <span class="text-2xl text-gray-400 font-normal">/ 5</span>
            </div>
            <p class="text-gray-500 font-bold">æ­£è§£æ•°</p>
        </div>
        
        <div class="bg-gray-50 p-6 rounded-xl mb-8 text-left text-sm text-gray-600">
            <h3 class="font-bold text-gray-800 mb-2 flex items-center gap-2">
                ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆ
            </h3>
            çœŸæ¨ªï¼ˆè¥¿ã‚„æ±ï¼‰ã‹ã‚‰è¦‹ã‚‹ã¨å‚¾ãã¯æœ€å¤§ã«ãªã‚Šã¾ã™ãŒã€æ–œã‚ã‹ã‚‰è¦‹ã‚‹ã¨å°‘ã—å‚¾ããŒå°ã•ãè¦‹ãˆã¾ã™ã€‚ã¾ãŸã€æ‰‹å‰ã‚„å¥¥ã«ã‚ã‚‹ã¨ãã®è¦‹ãˆæ–¹ï¼ˆå¤§ãã•ï¼‰ã‚‚ãƒ’ãƒ³ãƒˆã«ãªã‚Šã¾ã™ã‚ˆï¼
        </div>

        <button onclick="restartQuiz()" class="w-full py-3 bg-teal-600 hover:bg-teal-700 text-white rounded-xl font-bold shadow-md flex items-center justify-center gap-2 transition">
            ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹
        </button>
    </div>

    <script>
        // --- ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
        const questions = [
            {
                id: 1,
                imageType: 'lean-right',
                correctPosition: 'G', // è¥¿
                explanation: 'åœ°å›³ã®ã€Œè¥¿ï¼ˆGï¼‰ã€ã‹ã‚‰è¦‹ã‚‹ã¨ã€å—ã¸ã®å‚¾ãã¯ã€ŒçœŸå³ã€ã¸ã®å‚¾ãã¨ã—ã¦ã€ä¸€ç•ªå¤§ããå‚¾ã„ã¦è¦‹ãˆã¾ã™ã€‚',
                hintText: 'å¡”ãŒ <span class="text-blue-600 font-bold text-lg">å³</span> ã«å¤§ããå‚¾ã„ã¦ã„ã¾ã™'
            },
            {
                id: 2,
                imageType: 'straight-front',
                correctPosition: 'E', // å—
                explanation: 'åœ°å›³ã®ã€Œå—ï¼ˆEï¼‰ã€ã‹ã‚‰è¦‹ã‚‹ã¨ã€å¡”ã¯è‡ªåˆ†ã®æ–¹ï¼ˆæ‰‹å‰ï¼‰ã¸å€’ã‚Œã¦ãã‚‹ãŸã‚ã€å·¦å³ã«ã¯å‚¾ã„ã¦è¦‹ãˆã¾ã›ã‚“ã€‚',
                hintText: 'å¡”ãŒ <span class="text-blue-600 font-bold text-lg">ã¾ã£ã™ã</span> è¦‹ãˆã¾ã™<span class="text-sm text-gray-400">ï¼ˆæ‰‹å‰ï¼‰</span>'
            },
            {
                id: 3,
                imageType: 'lean-left-back',
                correctPosition: 'B', // åŒ—æ±
                explanation: 'åœ°å›³ã®ã€ŒåŒ—æ±ï¼ˆBï¼‰ã€ã‹ã‚‰è¦‹ã‚‹ã¨ã€å¡”ã¯ã€Œå·¦æ–œã‚å¥¥ã€ã¸å‚¾ã„ã¦è¦‹ãˆã¾ã™ã€‚çœŸæ¨ªï¼ˆæ±ï¼‰ã‹ã‚‰è¦‹ã‚‹ã‚ˆã‚Šã‚‚ã€å‚¾ããŒå°‘ã—ç·©ã‚„ã‹ã«è¦‹ãˆã¾ã™ã€‚',
                hintText: 'å¡”ãŒ <span class="text-blue-600 font-bold text-lg">å·¦</span> ã«å°‘ã—å‚¾ã„ã¦ã„ã¾ã™'
            },
            {
                id: 4,
                imageType: 'straight-back',
                correctPosition: 'A', // åŒ—
                explanation: 'åœ°å›³ã®ã€ŒåŒ—ï¼ˆAï¼‰ã€ã‹ã‚‰è¦‹ã‚‹ã¨ã€å¡”ã¯ã¾ã£ã™ãå¥¥ã¸å€’ã‚Œã¦ã„ã‚‹ãŸã‚ã€å·¦å³ã«ã¯å‚¾ã„ã¦è¦‹ãˆã¾ã›ã‚“ã€‚',
                hintText: 'å¡”ãŒ <span class="text-blue-600 font-bold text-lg">ã¾ã£ã™ã</span> è¦‹ãˆã¾ã™<span class="text-sm text-gray-400">ï¼ˆå¥¥ï¼‰</span>'
            },
            {
                id: 5,
                imageType: 'lean-right-front',
                correctPosition: 'F', // å—è¥¿
                explanation: 'åœ°å›³ã®ã€Œå—è¥¿ï¼ˆFï¼‰ã€ã‹ã‚‰è¦‹ã‚‹ã¨ã€å¡”ã¯ã€Œå³æ–œã‚æ‰‹å‰ã€ã¸å‚¾ã„ã¦è¦‹ãˆã¾ã™ã€‚çœŸæ¨ªï¼ˆè¥¿ï¼‰ã‹ã‚‰è¦‹ã‚‹ã®ã¨é•ã„ã€å°‘ã—æ‰‹å‰ã«è¿«ã£ã¦ãã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚',
                hintText: 'å¡”ãŒ <span class="text-blue-600 font-bold text-lg">å³</span> ã«å°‘ã—å‚¾ã„ã¦ã„ã¾ã™'
            },
        ];

        const positions = [
            { id: 'A', label: 'A', style: 'top: 2%; left: 50%; transform: translateX(-50%);' }, // åŒ—
            { id: 'B', label: 'B', style: 'top: 15%; right: 15%;' }, // åŒ—æ±
            { id: 'C', label: 'C', style: 'top: 50%; right: 2%; transform: translateY(-50%);' }, // æ±
            { id: 'D', label: 'D', style: 'bottom: 15%; right: 15%;' }, // å—æ±
            { id: 'E', label: 'E', style: 'bottom: 2%; left: 50%; transform: translateX(-50%);' }, // å—
            { id: 'F', label: 'F', style: 'bottom: 15%; left: 15%;' }, // å—è¥¿
            { id: 'G', label: 'G', style: 'top: 50%; left: 2%; transform: translateY(-50%);' }, // è¥¿
            { id: 'H', label: 'H', style: 'top: 15%; left: 15%;' }, // åŒ—è¥¿
        ];

        // --- çŠ¶æ…‹ç®¡ç† ---
        let currentQIndex = 0;
        let score = 0;
        let selectedPos = null;
        let isAnswered = false;

        // --- SVGç”Ÿæˆé–¢æ•° ---
        function getTowerSvg(type) {
            const ground = '<path d="M10 180 L190 180" stroke="#4B5563" stroke-width="4" stroke-linecap="round"/>';
            let content = '';

            if (type === 'lean-right') {
                content = `
                <g transform="rotate(15, 100, 180)">
                   <rect x="70" y="40" width="60" height="140" rx="4" fill="#FDE047" stroke="#B45309" stroke-width="4" />
                   <path d="M70 60 H130 M70 90 H130 M70 120 H130 M70 150 H130" stroke="#B45309" stroke-width="2" stroke-dasharray="4 2" />
                   <rect x="65" y="30" width="70" height="10" fill="#B45309" rx="2" />
                   <path d="M75 40 V180 M125 40 V180" stroke="#B45309" stroke-width="1" opacity="0.5"/>
                </g>`;
            } else if (type === 'lean-left') {
                content = `
                <g transform="rotate(-15, 100, 180)">
                   <rect x="70" y="40" width="60" height="140" rx="4" fill="#FDE047" stroke="#B45309" stroke-width="4" />
                   <path d="M70 60 H130 M70 90 H130 M70 120 H130 M70 150 H130" stroke="#B45309" stroke-width="2" stroke-dasharray="4 2" />
                   <rect x="65" y="30" width="70" height="10" fill="#B45309" rx="2" />
                   <path d="M75 40 V180 M125 40 V180" stroke="#B45309" stroke-width="1" opacity="0.5"/>
                </g>`;
            } else if (type === 'straight-front') {
                content = `
                <g>
                   <rect x="65" y="35" width="70" height="145" rx="4" fill="#FDE047" stroke="#B45309" stroke-width="4" />
                   <path d="M65 55 H135 M65 85 H135 M65 115 H135 M65 145 H135" stroke="#B45309" stroke-width="2" stroke-dasharray="4 2" />
                   <rect x="60" y="25" width="80" height="10" fill="#B45309" rx="2" />
                   <path d="M80 35 L70 180" stroke="#B45309" stroke-width="1" opacity="0.3"/>
                   <path d="M120 35 L130 180" stroke="#B45309" stroke-width="1" opacity="0.3"/>
                </g>`;
            } else if (type === 'straight-back') {
                content = `
                <g>
                   <rect x="70" y="40" width="60" height="140" rx="4" fill="#FDE047" stroke="#B45309" stroke-width="4" />
                   <path d="M70 60 H130 M70 90 H130 M70 120 H130 M70 150 H130" stroke="#B45309" stroke-width="2" stroke-dasharray="4 2" />
                   <rect x="65" y="30" width="70" height="10" fill="#B45309" rx="2" />
                   <path d="M75 40 V180 M125 40 V180" stroke="#B45309" stroke-width="1" opacity="0.5"/>
                   <path d="M80 40 L80 180" stroke="#B45309" stroke-width="1" opacity="0.3"/>
                   <path d="M120 40 L120 180" stroke="#B45309" stroke-width="1" opacity="0.3"/>
                </g>`;
            } else if (type === 'lean-left-back') {
                content = `
                <g transform="translate(5, 5) rotate(-8, 100, 180)">
                   <rect x="72" y="45" width="56" height="135" rx="4" fill="#FDE047" stroke="#B45309" stroke-width="4" />
                   <path d="M72 65 H128 M72 95 H128 M72 125 H128 M72 155 H128" stroke="#B45309" stroke-width="2" stroke-dasharray="4 2" />
                   <rect x="68" y="35" width="64" height="10" fill="#B45309" rx="2" />
                </g>`;
            } else if (type === 'lean-right-front') {
                content = `
                <g transform="translate(-5, -5) rotate(8, 100, 180)">
                   <rect x="68" y="35" width="64" height="145" rx="4" fill="#FDE047" stroke="#B45309" stroke-width="4" />
                   <path d="M68 55 H132 M68 85 H132 M68 115 H132 M68 145 H132" stroke="#B45309" stroke-width="2" stroke-dasharray="4 2" />
                   <rect x="64" y="25" width="72" height="10" fill="#B45309" rx="2" />
                </g>`;
            }

            return `<svg viewBox="0 0 200 200" class="w-full h-full">
                <text x="10" y="25" font-size="14" fill="#1E40AF" font-weight="bold">å†™çœŸ</text>
                ${ground}
                ${content}
            </svg>`;
        }

        // --- æ“ä½œãƒ­ã‚¸ãƒƒã‚¯ ---

        function startQuiz() {
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            score = 0;
            currentQIndex = 0;
            renderQuestion();
        }

        function restartQuiz() {
            document.getElementById('final-screen').classList.add('hidden');
            startQuiz();
        }

        function renderQuestion() {
            const q = questions[currentQIndex];
            selectedPos = null;
            isAnswered = false;

            // UIæ›´æ–°
            document.getElementById('q-num').textContent = currentQIndex + 1;
            document.getElementById('current-score').textContent = score;
            document.getElementById('tower-image-container').innerHTML = getTowerSvg(q.imageType);
            document.getElementById('image-hint').innerHTML = q.hintText;

            // ãƒœã‚¿ãƒ³ç”Ÿæˆ
            const mapContainer = document.getElementById('map-buttons');
            mapContainer.innerHTML = '';
            
            positions.forEach(pos => {
                const btn = document.createElement('button');
                btn.className = `camera-btn absolute w-10 h-10 md:w-12 md:h-12 rounded-full border-2 font-bold shadow-md flex items-center justify-center z-10 text-sm md:text-base bg-white border-blue-300 text-blue-600 hover:bg-blue-50`;
                btn.style.cssText = pos.style;
                btn.textContent = pos.label;
                btn.onclick = () => selectPosition(pos.id, btn);
                btn.id = `btn-${pos.id}`;
                mapContainer.appendChild(btn);
            });

            // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ã®ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('submit-section').classList.remove('hidden');
            document.getElementById('result-section').classList.add('hidden');
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = true;
            submitBtn.className = "w-full py-3 rounded-xl font-bold text-lg shadow-md transition-all bg-gray-200 text-gray-400 cursor-not-allowed";
        }

        function selectPosition(posId, btnElement) {
            if (isAnswered) return;

            // é¸æŠçŠ¶æ…‹ã®æ›´æ–°
            selectedPos = posId;

            // å…¨ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ãƒªã‚»ãƒƒãƒˆ
            document.querySelectorAll('.camera-btn').forEach(b => {
                b.className = "camera-btn absolute w-10 h-10 md:w-12 md:h-12 rounded-full border-2 font-bold shadow-md flex items-center justify-center z-10 text-sm md:text-base bg-white border-blue-300 text-blue-600 hover:bg-blue-50";
            });

            // é¸æŠã•ã‚ŒãŸãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«
            btnElement.className = "camera-btn absolute w-10 h-10 md:w-12 md:h-12 rounded-full border-2 font-bold shadow-md flex items-center justify-center z-10 text-sm md:text-base bg-blue-600 border-blue-700 text-white ring-2 ring-blue-300";

            // å›ç­”ãƒœã‚¿ãƒ³æœ‰åŠ¹åŒ–
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = false;
            submitBtn.className = "w-full py-3 rounded-xl font-bold text-lg shadow-md transition-all bg-indigo-600 hover:bg-indigo-700 text-white transform hover:scale-[1.02]";
        }

        function submitAnswer() {
            if (!selectedPos || isAnswered) return;
            isAnswered = true;

            const q = questions[currentQIndex];
            const isCorrect = selectedPos === q.correctPosition;
            
            if (isCorrect) score++;

            // â˜… ã‚¹ã‚³ã‚¢è¡¨ç¤ºã‚’å³æ™‚æ›´æ–°
            document.getElementById('current-score').textContent = score;

            // åœ°å›³ä¸Šã®ãƒœã‚¿ãƒ³ã®è‰²åˆ†ã‘ï¼ˆæ­£è§£ãƒ»ä¸æ­£è§£ã®è¡¨ç¤ºï¼‰
            document.querySelectorAll('.camera-btn').forEach(btn => {
                const posId = btn.id.replace('btn-', '');
                btn.disabled = true;
                
                if (posId === q.correctPosition) {
                    // æ­£è§£ã®å ´æ‰€ï¼ˆç·‘ï¼‰
                    btn.className = `absolute w-10 h-10 md:w-12 md:h-12 rounded-full border-2 font-bold shadow-md flex items-center justify-center z-20 text-sm md:text-base bg-green-500 border-green-600 text-white ring-4 ring-green-200`;
                } else if (posId === selectedPos && !isCorrect) {
                    // é–“é•ã£ã¦é¸ã‚“ã å ´æ‰€ï¼ˆèµ¤ï¼‰
                    btn.className = `absolute w-10 h-10 md:w-12 md:h-12 rounded-full border-2 font-bold shadow-md flex items-center justify-center z-10 text-sm md:text-base bg-red-500 border-red-600 text-white opacity-80`;
                } else {
                    // ãã®ä»–ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼‰
                    btn.classList.add('bg-gray-100', 'border-gray-200', 'text-gray-400', 'opacity-50');
                    btn.classList.remove('bg-white', 'text-blue-600');
                }
            });

            // çµæœã‚¨ãƒªã‚¢ã®è¡¨ç¤º
            document.getElementById('submit-section').classList.add('hidden');
            const resultSection = document.getElementById('result-section');
            resultSection.classList.remove('hidden');
            
            // çµæœã®ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®šï¼ˆâ˜…ã“ã“ã‚’ä¿®æ­£ï¼šhiddenã‚’å«ã‚ãªã„ã‚ˆã†ã«ï¼ï¼‰
            if (isCorrect) {
                resultSection.className = "p-4 rounded-xl border-2 fade-in bg-green-50 border-green-200";
                document.getElementById('result-icon').innerHTML = '<svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="text-green-600"><polyline points="20 6 9 17 4 12"></polyline></svg>';
                document.getElementById('result-title').textContent = "æ­£è§£ï¼";
                document.getElementById('result-title').className = "text-xl font-bold text-green-700";
            } else {
                resultSection.className = "p-4 rounded-xl border-2 fade-in bg-red-50 border-red-200";
                document.getElementById('result-icon').innerHTML = '<svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="text-red-600"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>';
                document.getElementById('result-title').textContent = "ã–ã‚“ã­ã‚“...";
                document.getElementById('result-title').className = "text-xl font-bold text-red-700";
            }

            document.getElementById('explanation-text').textContent = q.explanation;
            document.getElementById('next-btn').textContent = (currentQIndex < questions.length - 1) ? 'æ¬¡ã®å•é¡Œã¸' : 'çµæœã‚’è¦‹ã‚‹';
        }

        function nextQuestion() {
            if (currentQIndex < questions.length - 1) {
                currentQIndex++;
                renderQuestion();
            } else {
                showFinalResult();
            }
        }

        function showFinalResult() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('final-screen').classList.remove('hidden');
            document.getElementById('final-score').textContent = score;
        }

    </script>
</body>
</html>